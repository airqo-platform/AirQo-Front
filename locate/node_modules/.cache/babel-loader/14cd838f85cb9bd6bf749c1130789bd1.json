{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Documents\\\\Projects\\\\AirQo-frontend\\\\locate\\\\src\\\\views\\\\components\\\\DataDisplay\\\\Map\\\\Map.js\";\nimport React from 'react';\nimport clsx from 'clsx';\nimport PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/styles';\nimport { Map as LeafletMap, TileLayer, Popup, Marker } from 'react-leaflet';\nimport { Link } from 'react-router-dom';\nimport { Card, CardContent, CardHeader, Divider } from '@material-ui/core';\nimport { useEffect, useState } from 'react';\nimport FullscreenControl from 'react-leaflet-fullscreen';\nimport 'react-leaflet-fullscreen/dist/styles.css';\nimport L from 'leaflet'; // import Filter from './Filter';\n\nimport axios from \"axios\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    // height: '100%',\n    padding: '0',\n    margin: 0,\n    border: 0\n  },\n  content: {\n    alignItems: 'center',\n    display: 'flex'\n  },\n  title: {\n    fontWeight: 700\n  },\n  avatar: {\n    backgroundColor: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    height: 56,\n    width: 56\n  },\n  icon: {\n    height: 32,\n    width: 32\n  },\n  progress: {\n    marginTop: theme.spacing(3)\n  }\n}));\n\nconst Map = props => {\n  const {\n    className,\n    ...rest\n  } = props;\n  const classes = useStyles();\n  const [magnitude, setMagnitude] = useState('All');\n  const [contacts, setContacts] = useState([]);\n  useEffect(() => {\n    fetch('http://127.0.0.1:5000/api/v1/device/monitor/status') //fetch('http://127.0.0.1:5000/api/v1/dashboard/monitoringsites?organisation_name=KCCA')\n    .then(res => res.json()).then(contactData => {\n      setContacts(contactData);\n    }).catch(console.log);\n  }, []);\n\n  let getPm25CategoryColorClass = aqi => {\n    return aqi > 250.4 ? 'pm25Harzadous' : aqi > 150.4 ? 'pm25VeryUnHealthy' : aqi > 55.4 ? 'pm25UnHealthy' : aqi > 35.4 ? 'pm25UH4SG' : aqi > 12 ? 'pm25Moderate' : aqi > 0 ? 'pm25Good' : 'pm25UnCategorised';\n  };\n\n  let fetchFilteredData = magnitude => {\n    //this.setState({ isLoaded: false }, () => {\n    fetch('http://127.0.0.1:5000/api/v1/device/monitor/status').then(res => res.json()).then(contactData => {\n      setContacts(contactData);\n    });\n  };\n\n  return React.createElement(Card, Object.assign({}, rest, {\n    className: clsx(classes.root, className),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }), React.createElement(CardHeader, {\n    title: \"Devices\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }), React.createElement(Divider, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }), React.createElement(CardContent, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, React.createElement(LeafletMap, {\n    animate: true,\n    attributionControl: true,\n    center: [0.3341424, 32.5600613],\n    doubleClickZoom: true,\n    dragging: true,\n    easeLinearity: 0.35,\n    scrollWheelZoom: true,\n    zoom: 7,\n    zoomControl: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, React.createElement(TileLayer, {\n    url: \"http://{s}.tile.osm.org/{z}/{x}/{y}.png\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }), contacts.map(contact => React.createElement(Marker, {\n    position: [contact.loc_lat, contact.loc_long],\n    fill: \"true\",\n    key: contact._id,\n    clickable: \"true\",\n    icon: L.divIcon({\n      // html:`${contact.Last_Hour_PM25_Value == 0?'':contact.Last_Hour_PM25_Value}`,\n      iconSize: 35,\n      // className:`leaflet_marker_icon ${getPm25CategoryColorClass(contact.Last_Hour_PM25_Value)}`\n      className: 'leaflet-marker-icon'\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  })), React.createElement(FullscreenControl, {\n    position: \"topright\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  }))));\n};\n\nMap.propTypes = {\n  className: PropTypes.string\n};\nexport default Map;","map":{"version":3,"sources":["C:/Users/User/Documents/Projects/AirQo-frontend/locate/src/views/components/DataDisplay/Map/Map.js"],"names":["React","clsx","PropTypes","makeStyles","Map","LeafletMap","TileLayer","Popup","Marker","Link","Card","CardContent","CardHeader","Divider","useEffect","useState","FullscreenControl","L","axios","useStyles","theme","root","padding","margin","border","content","alignItems","display","title","fontWeight","avatar","backgroundColor","palette","primary","main","color","contrastText","height","width","icon","progress","marginTop","spacing","props","className","rest","classes","magnitude","setMagnitude","contacts","setContacts","fetch","then","res","json","contactData","catch","console","log","getPm25CategoryColorClass","aqi","fetchFilteredData","map","contact","loc_lat","loc_long","_id","divIcon","iconSize","propTypes","string"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport clsx from 'clsx';\r\nimport PropTypes from 'prop-types';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport { Map as LeafletMap, TileLayer, Popup, Marker} from 'react-leaflet';\r\nimport {Link } from 'react-router-dom';\r\nimport {Card, CardContent, CardHeader, Divider} from '@material-ui/core';\r\nimport { useEffect, useState } from 'react';\r\nimport FullscreenControl from 'react-leaflet-fullscreen';\r\nimport 'react-leaflet-fullscreen/dist/styles.css';\r\nimport L from 'leaflet';\r\n// import Filter from './Filter';\r\nimport axios from \"axios\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  root: {\r\n    // height: '100%',\r\n    padding: '0',\r\n\t  margin: 0,\r\n\t  border: 0,  \r\n  },\r\n  content: {\r\n    alignItems: 'center',\r\n    display: 'flex'\r\n  },\r\n  title: {\r\n    fontWeight: 700\r\n  },\r\n  avatar: {\r\n    backgroundColor: theme.palette.primary.main,\r\n    color: theme.palette.primary.contrastText,\r\n    height: 56,\r\n    width: 56\r\n  },\r\n  icon: {\r\n    height: 32,\r\n    width: 32\r\n  },\r\n  progress: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n}));\r\n\r\nconst Map = props => {\r\n  const { className, ...rest } = props;\r\n\r\n  const classes = useStyles();\r\n  const [magnitude,setMagnitude ] = useState('All');\r\n  const [contacts,setContacts ] = useState([]);\r\n\r\n  useEffect(() => {\r\n   fetch('http://127.0.0.1:5000/api/v1/device/monitor/status')\r\n    //fetch('http://127.0.0.1:5000/api/v1/dashboard/monitoringsites?organisation_name=KCCA')\r\n      .then(res => res.json())\r\n      .then((contactData) => {\r\n        setContacts(contactData)\r\n      })\r\n      .catch(console.log)\r\n  },[]);\r\n\r\n  let getPm25CategoryColorClass = (aqi) =>{\r\n    return aqi > 250.4  ? 'pm25Harzadous' :\r\n      aqi > 150.4  ? 'pm25VeryUnHealthy' :\r\n        aqi > 55.4   ? 'pm25UnHealthy' :\r\n          aqi > 35.4   ? 'pm25UH4SG' :\r\n            aqi > 12   ? 'pm25Moderate' :\r\n              aqi > 0   ? 'pm25Good' :\r\n                'pm25UnCategorised';\r\n  }\r\n\r\n  let fetchFilteredData = (magnitude) => {\r\n    //this.setState({ isLoaded: false }, () => {\r\n    fetch('http://127.0.0.1:5000/api/v1/device/monitor/status')\r\n      .then(res => res.json())\r\n      .then((contactData) => {\r\n        setContacts(contactData)\r\n      });\r\n  };\r\n\r\n  return (\r\n    <Card\r\n      {...rest}\r\n      className={clsx(classes.root, className)}\r\n    >\r\n      <CardHeader        \r\n        title=\"Devices\"\r\n      />\r\n      <Divider />\r\n            \r\n      <CardContent>\r\n        <LeafletMap\r\n          animate\r\n          attributionControl\r\n          center={[0.3341424,32.5600613]}\r\n          doubleClickZoom\r\n          dragging\r\n          easeLinearity={0.35}\r\n          scrollWheelZoom\r\n          zoom={7}\r\n          \r\n          zoomControl        \r\n          \r\n        >\r\n          <TileLayer\r\n            url=\"http://{s}.tile.osm.org/{z}/{x}/{y}.png\"\r\n          />           \r\n          {contacts.map((contact) => (\r\n\r\n            <Marker \r\n              position={[contact.loc_lat,contact.loc_long]}\r\n              fill=\"true\"\r\n              key={contact._id} \r\n              clickable=\"true\"  \r\n              icon={\r\n                L.divIcon({\r\n                // html:`${contact.Last_Hour_PM25_Value == 0?'':contact.Last_Hour_PM25_Value}`,\r\n                iconSize: 35,\r\n                // className:`leaflet_marker_icon ${getPm25CategoryColorClass(contact.Last_Hour_PM25_Value)}`\r\n                className:'leaflet-marker-icon'\r\n                 })}\r\n              >\r\n              \r\n              {/* <Popup>\r\n                <h2>{contact.Parish} - {contact.Division} Division</h2> \r\n                <h4>{contact.LocationCode}</h4>\r\n\r\n                <h1> {contact.Last_Hour_PM25_Value == 0?'':contact.Last_Hour_PM25_Value}</h1> \r\n                <span>Last Refreshed: {contact.LastHour} (UTC)</span>\r\n                <Divider/>\r\n\r\n                \r\n               \r\n                <Link to={`/location/${contact.Parish}`}>More Details</Link>\r\n                \r\n              </Popup> */}\r\n            </Marker>   \r\n          ))}    \r\n      \r\n          <FullscreenControl position=\"topright\" />\r\n\r\n          {/* <Filter fetchFilteredData={fetchFilteredData} /> */}\r\n\r\n        </LeafletMap>\r\n        \r\n      </CardContent>\r\n  \r\n\r\n    </Card>\r\n\r\n  );\r\n};\r\n\r\n\r\nMap.propTypes = {\r\n  className: PropTypes.string\r\n};\r\n\r\nexport default Map;\r\n"]},"metadata":{},"sourceType":"module"}